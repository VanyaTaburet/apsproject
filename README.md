# Vagonach

# Участники проекта

Разработчик проекта Vagonach (Open Source)

# Определение проблемы

Современные форумы и социальные сети часто перегружены лишним функционалом, скриптами и рекламой. Существует потребность в легком, быстром и анонимном движке для общения, вдохновленном классическими имиджбордами (2channel, 4chan), который был бы простым в развертывании и производительным на слабом железе.

# Выработка требований - пользовательские сценарии

- Просмотр тредов и досок без регистрации
- Анонимный постинг изображений и ответов
- Модерация контента

#### 1\. *Просмотр (Reader)*
&nbsp;	Я — пользователь, я хочу зайти на доску, увидеть список актуальных тредов с превью изображений и быстро открыть интересующую дискуссию.

#### 2\. *Публикация (Poster)*
&nbsp;	Я хочу создать новый тред или ответить в существующий, прикрепив изображение, без необходимости создавать аккаунт.

#### 3\. *Навигация*
&nbsp;	Я хочу видеть список последних активных тредов на главной странице для быстрого доступа к "горячим" темам.

#### 4\. *Администрирование*
&nbsp;	Я — администратор, я хочу через веб-интерфейс удалять спам, закреплять важные треды или закрывать обсуждения.

# Архитектура проекта

## *Стек технологий*

#### Backend & Logic
- **Go (Golang):** Основная логика приложения, обеспечивающая высокую скорость и конкурентность.
- **PostgreSQL:** Надежное хранение постов, тредов и метаданных.

#### Frontend & Rendering
- **HTMX:** Обеспечение интерактивности (AJAX) без сложных SPA-фреймворков.
- **HTML Templates:** Серверный рендеринг для максимальной скорости загрузки страниц.

## *Структура проекта (Container Diagram)*
Проект следует принципам чистой архитектуры:
- `cmd/vagonach/` — Точка входа (main).
- `internal/entity/` — Доменные модели (Board, Thread, Post).
- `internal/repository/` — Слой работы с БД (SQL-запросы).
- `internal/transport/http/` — HTTP-хендлеры и маршрутизация.
- `web/` — Шаблоны (templates) и статика (CSS, images).

## *Контракты API*

#### Public
- Список досок: `GET /boards`
- Треды доски: `GET /boards/:slug/threads`
- Просмотр треда: `GET /threads/:id`
- Создание треда: `POST /boards/:slug/threads`
- Создание поста: `POST /threads/:id/posts`

#### Admin
- Вход: `POST /admin/login`
- Дашборд: `GET /admin`
- Управление тредом: `POST /admin/threads/:id/{delete|sticky|lock}`

## *Метрики кодовой базы*
- **CSS:** ~2600 строк (Стилизация)
- **Go:** ~1450 строк (Логика)
- **HTML:** ~850 строк (Разметка)
- **SQL:** ~40 строк (Схемы)

## *Нефункциональные требования*
- **Производительность:** Страницы должны генерироваться на сервере и отдаваться клиенту с минимальной задержкой.
- **Минимализм:** Отсутствие тяжелых JS-библиотек на клиенте.
- **Надежность:** Использование транзакционной БД для целостности данных.

# Схема масштабирования сервиса

## Горизонтальное масштабирование
- **Application:** Приложение компилируется в единый бинарный файл. Возможно запускать несколько реплик за Nginx/Load Balancer.
- **Storage:** PostgreSQL поддерживает репликацию (Master-Slave) для разделения нагрузки на чтение и запись.

## Вертикальное масштабирование
- Go эффективно утилизирует многоядерные процессоры (goroutines), поэтому вертикальное масштабирование сервера дает линейный прирост производительности.

# Визуализация интерфейса

#### 1. Главная страница
Обзор навигации и структуры борды.

#### 2. Просмотр треда
Классический вид имиджборды: ОП-пост, ответы, форма отправки.

#### 3. Панель администратора
Интерфейс для управления контентом (бан, удаление, закрепление).

# Сборка и запуск

#### Предварительные требования
- Go 1.18+
- PostgreSQL
- Настроенный конфиг (в `configs/`)

#### Инструкция
1. **Миграции:** Примените SQL-схемы из `internal/db/migrations/` к вашей базе данных.
2. **Запуск:**
   ```bash
   go run cmd/vagonach/main.go
